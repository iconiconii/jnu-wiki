# 防抖功能测试指南

## 已实现的防抖机制

### 前端防抖
1. **提交按钮防抖**: 2秒内禁止重复提交
2. **视觉反馈**: 防抖期间按钮变为琥珀色，显示"请等待..."
3. **错误提示**: 显示倒计时提示用户等待时间

### 后端防重复提交
1. **内容指纹**: 基于标题+URL+描述生成唯一指纹
2. **5分钟冷却**: 相同内容5分钟内无法重复提交
3. **IP + 频率限制**: 15分钟内最多5次提交

## 测试步骤

### 1. 测试前端防抖
1. 打开投稿表单
2. 填写完整信息
3. 快速连续点击"提交投稿"按钮
4. **预期结果**: 
   - 第一次点击正常提交
   - 2秒内的后续点击会显示"请等待 X 秒后再次提交"
   - 按钮变为琥珀色并显示"请等待..."

### 2. 测试后端防重复
1. 提交一个投稿
2. 立即使用相同的标题、URL、描述再次提交
3. **预期结果**: 
   - 返回429状态码
   - 错误信息："相似内容已经提交，请等待 X 秒后再试"

### 3. 测试频率限制
1. 在15分钟内提交6个不同的投稿
2. **预期结果**:
   - 前5个正常提交
   - 第6个返回429状态码
   - 错误信息："提交过于频繁，请稍后再试"

## 技术实现要点

### useDebounce Hook
```typescript
// 防抖提交，2秒冷却时间
const { debouncedSubmit } = useDebouncedSubmit(performSubmit, 2000)

// 前端状态检查
if (now - lastSubmitAttempt < 2000) {
  setSubmitStatus('debouncing')
  // 显示倒计时提示
}
```

### 后端防护
```typescript
// 内容指纹生成
const contentFingerprint = generateSubmissionFingerprint(title, url, description)

// 重复提交检查
const duplicateCheck = checkDuplicateSubmission(contentFingerprint)

// 5分钟冷却期
const cooldownTime = 5 * 60 * 1000
```

## 配置参数

| 参数 | 值 | 说明 |
|------|----|----- |
| 前端防抖时间 | 2秒 | 按钮点击间隔限制 |
| 后端重复检查 | 5分钟 | 相同内容提交间隔 |
| 频率限制 | 5次/15分钟 | IP级别的提交频率 |
| 内容指纹长度 | 100字符 | 描述截取长度 |

## 安全特性

1. ✅ **双重防护**: 前端+后端双层防抖
2. ✅ **内容去重**: 基于内容指纹的智能去重
3. ✅ **IP限制**: 防止恶意刷屏
4. ✅ **用户体验**: 友好的错误提示和视觉反馈
5. ✅ **自动清理**: 过期记录自动清理，节省内存